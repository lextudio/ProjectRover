<!--
// Copyright (c) 2025-2026 LeXtudio Inc.
// 
// Permission is hereby granted, free of charge, to any person obtaining a copy of this
// software and associated documentation files (the "Software"), to deal in the Software
// without restriction, including without limitation the rights to use, copy, modify, merge,
// publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons
// to whom the Software is furnished to do so, subject to the following conditions:
// 
// The above copyright notice and this permission notice shall be included in all copies or
// substantial portions of the Software.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
// PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE
// FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
// DEALINGS IN THE SOFTWARE.
-->
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:cv="clr-namespace:Avalonia.Data.Converters;assembly=Avalonia.Base"
             xmlns:converters="clr-namespace:ICSharpCode.ILSpy.Converters;assembly=ProjectRover"
             xmlns:treeView="clr-namespace:ICSharpCode.ILSpyX.TreeView;assembly=ICSharpCode.ILSpyX"
             xmlns:analyzers="clr-namespace:ICSharpCode.ILSpy.Analyzers;assembly=ProjectRover"
             x:Class="ICSharpCode.ILSpy.Analyzers.AnalyzerTreeView"
             x:DataType="analyzers:AnalyzerTreeViewModel">
  <UserControl.Resources>
    <converters:NodeForegroundConverter x:Key="NodeForegroundConverter" />
    <converters:IconKeyThemeToImageConverter x:Key="IconKeyThemeToImageConverter" />
  </UserControl.Resources>

  <Border Background="Transparent" BorderThickness="0">
    <TreeView x:Name="tree"
              ItemsSource="{Binding Root.Children}"
              SelectionMode="Single">
      <TreeView.Styles>
        <Style Selector="TreeViewItem" x:DataType="treeView:SharpTreeNode">
          <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
          <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
        </Style>
      </TreeView.Styles>
      <TreeView.ItemTemplate>
        <TreeDataTemplate DataType="treeView:SharpTreeNode" ItemsSource="{Binding ViewChildren}">
          <StackPanel Orientation="Horizontal" Background="Transparent">
            <Panel Width="16" Height="16" Margin="0,0,5,0">
              <Image Width="16" Height="16" VerticalAlignment="Center">
                <Image.Source>
                  <MultiBinding Converter="{StaticResource IconKeyThemeToImageConverter}">
                    <Binding Path="Icon" />
                    <Binding Path="ActualThemeVariant" Source="{x:Static Application.Current}" />
                  </MultiBinding>
                </Image.Source>
                <Image.IsVisible>
                  <Binding Path="Icon" Converter="{x:Static cv:ObjectConverters.IsNotNull}" />
                </Image.IsVisible>
              </Image>
            </Panel>
            <TextBlock Text="{Binding Text}"
                       VerticalAlignment="Center"
                       Foreground="{Binding ., Converter={StaticResource NodeForegroundConverter}}" />
          </StackPanel>
        </TreeDataTemplate>
      </TreeView.ItemTemplate>
      <TreeView.KeyBindings>
        <KeyBinding Gesture="Ctrl+R" Command="{Binding AnalyzeCommand}" />
      </TreeView.KeyBindings>
    </TreeView>
  </Border>
</UserControl>
